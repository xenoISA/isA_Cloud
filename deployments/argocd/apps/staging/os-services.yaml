# =============================================================================
# OS Services - Staging
# =============================================================================
# Individual applications for each OS service
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: web-services-staging
  namespace: argocd
  labels:
    app: web-services
    environment: staging
    tier: os
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: https://github.com/your-org/isA_Cloud.git
    targetRevision: main
    path: deployments/charts/isa-service
    helm:
      valueFiles:
        - ../../../isA_OS/os_services/web_services/deployment/helm/values.yaml
        - ../../../isA_OS/os_services/web_services/deployment/helm/values-staging.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: isa-cloud-staging
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: cloud-os-staging
  namespace: argocd
  labels:
    app: cloud-os
    environment: staging
    tier: os
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: https://github.com/your-org/isA_Cloud.git
    targetRevision: main
    path: deployments/charts/isa-service
    helm:
      valueFiles:
        - ../../../isA_OS/os_services/cloud_os/deployment/helm/values.yaml
        - ../../../isA_OS/os_services/cloud_os/deployment/helm/values-staging.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: isa-cloud-staging
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: python-repl-staging
  namespace: argocd
  labels:
    app: python-repl
    environment: staging
    tier: os
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: https://github.com/your-org/isA_Cloud.git
    targetRevision: main
    path: deployments/charts/isa-service
    helm:
      valueFiles:
        - ../../../isA_OS/os_services/python_repl/deployment/helm/values.yaml
        - ../../../isA_OS/os_services/python_repl/deployment/helm/values-staging.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: isa-cloud-staging
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true

---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: pool-manager-staging
  namespace: argocd
  labels:
    app: pool-manager
    environment: staging
    tier: os
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: https://github.com/your-org/isA_Cloud.git
    targetRevision: main
    path: deployments/charts/isa-service
    helm:
      valueFiles:
        - ../../../isA_OS/os_services/pool_manager/deployment/helm/values.yaml
        - ../../../isA_OS/os_services/pool_manager/deployment/helm/values-staging.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: isa-cloud-staging
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
