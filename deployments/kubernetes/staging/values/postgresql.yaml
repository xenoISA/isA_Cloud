# PostgreSQL Helm Values - LOCAL STAGING (Simple)
# Chart: bitnami/postgresql
# Install: helm install postgresql bitnami/postgresql -n isa-cloud-staging -f helm-values/staging/postgresql.yaml
#
# ============================================
# IMPORTANT: Password Security
# ============================================
# DO NOT commit real passwords to version control!
#
# For production deployments, use one of these approaches:
# 1. Helm --set flag at deploy time:
#    helm install postgresql bitnami/postgresql \
#      --set auth.postgresPassword="YOUR_ACTUAL_PASSWORD" \
#      -n isa-cloud-staging -f postgresql.yaml
#
# 2. External secrets with Bitnami chart:
#    auth:
#      existingSecret: postgres-external-secret
#      secretKeys:
#        adminPasswordKey: password
#
# 3. HashiCorp Vault with Vault Agent Injector
#
# 4. AWS Secrets Manager with External Secrets Operator
# ============================================

# Simple standalone architecture for local dev
architecture: standalone

# Authentication
# CHANGE_ME: Use --set or existingSecret in production
auth:
  postgresPassword: "CHANGE_ME_USE_EXTERNAL_SECRETS"
  database: "isa_platform"

# Primary instance
primary:
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 2Gi

  persistence:
    enabled: true
    size: 20Gi

  # Basic performance tuning for local dev
  configuration: |
    max_connections = 100
    shared_buffers = 128MB
    effective_cache_size = 512MB
    work_mem = 4MB

  # Init scripts (extensions, etc.)
  initdb:
    scripts:
      00-extensions.sql: |
        CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
        CREATE EXTENSION IF NOT EXISTS "pg_trgm";

  podLabels:
    tier: infrastructure
    environment: staging

# Service - NodePort for local access
service:
  type: NodePort
  ports:
    postgresql: 5432
  nodePorts:
    postgresql: 5432

# Disable metrics for lighter footprint
metrics:
  enabled: false
