# ============================================
# isA Gateway - Staging Environment Configuration
# ============================================
# SECURITY: This file should NEVER be committed to version control.
# Copy from .env.gateway.example and populate with actual values.

# ============================================
# Environment
# ============================================
ENVIRONMENT=staging
DEBUG=false
LOG_LEVEL=INFO

# ============================================
# Gateway Service Configuration
# ============================================
GATEWAY_PORT=8000
SERVICE_NAME=gateway_service
SERVICE_PORT=8000

# ============================================
# Service Discovery (Docker Staging)
# ============================================
CONSUL_HOST=staging-consul
CONSUL_PORT=8500
CONSUL_ENABLED=true

# ============================================
# Message Queue (ECS Service Discovery)
# ============================================
NATS_URL=nats://nats-1.staging.isa.local:4222,nats://nats-2.staging.isa.local:4222,nats://nats-3.staging.isa.local:4222

# ============================================
# Cache (Redis) - ECS Service Discovery
# ============================================
REDIS_URL=redis://redis.staging.isa.local:6379

# ============================================
# Logging (Loki) - ECS Service Discovery
# ============================================
LOKI_URL=http://loki.staging.isa.local:3100
LOKI_ENABLED=true

# ============================================
# Backend Service URLs (ECS Service Discovery)
# ============================================
MCP_URL=http://mcp.staging.isa.local:8081
MODEL_URL=http://model.staging.isa.local:8082
AGENT_URL=http://agent.staging.isa.local:8080

# User Services URLs
ACCOUNT_SERVICE_URL=http://account.staging.isa.local:8201
AUTH_SERVICE_URL=http://auth.staging.isa.local:8202
AUTHORIZATION_SERVICE_URL=http://authorization.staging.isa.local:8203
SESSION_SERVICE_URL=http://session.staging.isa.local:8108
PAYMENT_SERVICE_URL=http://payment.staging.isa.local:8207

# Business Services URLs
NOTIFICATION_SERVICE_URL=http://notification.staging.isa.local:8104
WALLET_SERVICE_URL=http://wallet.staging.isa.local:8113
ORDER_SERVICE_URL=http://order.staging.isa.local:8105
STORAGE_SERVICE_URL=http://storage.staging.isa.local:8109
AUDIT_SERVICE_URL=http://audit.staging.isa.local:8102
TASK_SERVICE_URL=http://task.staging.isa.local:8110
ORGANIZATION_SERVICE_URL=http://organization.staging.isa.local:8106
INVITATION_SERVICE_URL=http://invitation.staging.isa.local:8103
EVENT_SERVICE_URL=http://event.staging.isa.local:8101

# IoT Services URLs
DEVICE_SERVICE_URL=http://device.staging.isa.local:8220
OTA_SERVICE_URL=http://ota.staging.isa.local:8107
TELEMETRY_SERVICE_URL=http://telemetry.staging.isa.local:8111

# ============================================
# Database Configuration (Supabase Cloud)
# ============================================
DATABASE_URL=postgresql://postgres:<your-db-password>@db.<your-project-ref>.supabase.co:5432/postgres?search_path=staging
SUPABASE_URL=https://<your-project-ref>.supabase.co
SUPABASE_ANON_KEY=<your-supabase-anon-key>
SUPABASE_SERVICE_ROLE_KEY=<your-supabase-service-role-key>

# ============================================
# Security Configuration
# ============================================
# CRITICAL: Generate cryptographically secure random secrets!
# Minimum requirements:
# - JWT_SECRET_KEY: 256-bit entropy (64 hex chars or 43 base64 chars)
#   Generate with: openssl rand -hex 32
# - ENCRYPTION_KEY: 256-bit entropy (32 bytes, base64 encoded)
#   Generate with: openssl rand -base64 32
# WARNING: Weak secrets can be brute-forced. Never use predictable values!
JWT_SECRET_KEY=<generate-with-openssl-rand-hex-32>
ENCRYPTION_KEY=<generate-with-openssl-rand-base64-32>
REQUIRE_AUTH=true

# ============================================
# CORS Configuration
# ============================================
# SECURITY WARNING: Wildcard (*) CORS with credentials is dangerous!
# It allows any website to make authenticated requests to your API.
# Always use explicit origin allowlists in production/staging.
# Example: CORS_ALLOWED_ORIGINS=https://app.example.com,https://staging.example.com
CORS_ALLOWED_ORIGINS=https://app.isa-cloud.example.com,https://staging.isa-cloud.example.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization
CORS_EXPOSED_HEADERS=X-Total-Count,X-Page-Count
CORS_MAX_AGE=3600
# Note: When using credentials, CORS_ALLOWED_ORIGINS cannot be '*'
CORS_CREDENTIALS=true

# ============================================
# Rate Limiting
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=50

# ============================================
# Proxy Configuration
# ============================================
PROXY_TIMEOUT=30
PROXY_MAX_IDLE_CONNS=100
PROXY_IDLE_CONN_TIMEOUT=90
